source('helper.R')

testMiddleNA <- function() {
  data <- data.frame(
    "ReadingDateTime"=c(
      '1/1/2009 0:00', '1/1/2009 1:00', '1/1/2009 2:00', '1/1/2009 3:00', '1/1/2009 4:00', '1/1/2009 5:00', '1/1/2009 6:00', '1/1/2009 7:00', '1/1/2009 8:00', '1/1/2009 9:00', '1/1/2009 10:00', '1/1/2009 11:00', '1/1/2009 12:00', '1/1/2009 13:00', '1/1/2009 14:00', '1/1/2009 15:00', '1/1/2009 16:00', '1/1/2009 17:00', '1/1/2009 18:00', '1/1/2009 19:00', '1/1/2009 20:00', '1/1/2009 21:00', '1/1/2009 22:00', '1/1/2009 23:00',
      '2/1/2009 0:00', '2/1/2009 1:00', '2/1/2009 2:00', '2/1/2009 3:00', '2/1/2009 4:00', '2/1/2009 5:00', '2/1/2009 6:00', '2/1/2009 7:00', '2/1/2009 8:00', '2/1/2009 9:00', '2/1/2009 10:00', '2/1/2009 11:00', '2/1/2009 12:00', '2/1/2009 13:00', '2/1/2009 14:00', '2/1/2009 15:00', '2/1/2009 16:00', '2/1/2009 17:00', '2/1/2009 18:00', '2/1/2009 19:00', '2/1/2009 20:00', '2/1/2009 21:00', '2/1/2009 22:00', '2/1/2009 23:00',
      '3/1/2009 0:00', '3/1/2009 1:00', '3/1/2009 2:00', '3/1/2009 3:00', '3/1/2009 4:00', '3/1/2009 5:00', '3/1/2009 6:00', '3/1/2009 7:00', '3/1/2009 8:00', '3/1/2009 9:00', '3/1/2009 10:00', '3/1/2009 11:00', '3/1/2009 12:00', '3/1/2009 13:00', '3/1/2009 14:00', '3/1/2009 15:00', '3/1/2009 16:00', '3/1/2009 17:00', '3/1/2009 18:00', '3/1/2009 19:00', '3/1/2009 20:00', '3/1/2009 21:00', '3/1/2009 22:00', '3/1/2009 23:00'
    ), 
    "Value" = c(
      1,   2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24,
      25, 26, 27, 28, 29, 30, 31, NA, 33, 34, NA, 36, 37, 38, 39, NA, 41, 42, 43, 44, 45, 46, 47, 48,
      49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72
    )
  )  
  
  if(!is.na(data$Value[32])) {
    print("Error: value[32] is avaliable")
  }
  
  if(!is.na(data$Value[35])) {
    print("Error: value[35] is avaliable")
  }
  
  if(!is.na(data$Value[40])) {
    print("Error: value[40] is avaliable")
  }
  
  result <- get.FillValueForTimeSeries(data)
  
  if(result$Value[32] != 8) {
    print("Error: value[32] must be 8")
  }
  
  if(result$Value[35] != 11) {
    print("Error: value[35] must be 11")
  }
  
  if(result$Value[40] != 16) {
    print("Error: value[40] must be 16")
  }
}



testBeginNA <- function() {
  data <- data.frame(
    "ReadingDateTime"=c(
      '1/1/2009 0:00', '1/1/2009 1:00', '1/1/2009 2:00', '1/1/2009 3:00', '1/1/2009 4:00', '1/1/2009 5:00', '1/1/2009 6:00', '1/1/2009 7:00', '1/1/2009 8:00', '1/1/2009 9:00', '1/1/2009 10:00', '1/1/2009 11:00', '1/1/2009 12:00', '1/1/2009 13:00', '1/1/2009 14:00', '1/1/2009 15:00', '1/1/2009 16:00', '1/1/2009 17:00', '1/1/2009 18:00', '1/1/2009 19:00', '1/1/2009 20:00', '1/1/2009 21:00', '1/1/2009 22:00', '1/1/2009 23:00',
      '2/1/2009 0:00', '2/1/2009 1:00', '2/1/2009 2:00', '2/1/2009 3:00', '2/1/2009 4:00', '2/1/2009 5:00', '2/1/2009 6:00', '2/1/2009 7:00', '2/1/2009 8:00', '2/1/2009 9:00', '2/1/2009 10:00', '2/1/2009 11:00', '2/1/2009 12:00', '2/1/2009 13:00', '2/1/2009 14:00', '2/1/2009 15:00', '2/1/2009 16:00', '2/1/2009 17:00', '2/1/2009 18:00', '2/1/2009 19:00', '2/1/2009 20:00', '2/1/2009 21:00', '2/1/2009 22:00', '2/1/2009 23:00',
      '3/1/2009 0:00', '3/1/2009 1:00', '3/1/2009 2:00', '3/1/2009 3:00', '3/1/2009 4:00', '3/1/2009 5:00', '3/1/2009 6:00', '3/1/2009 7:00', '3/1/2009 8:00', '3/1/2009 9:00', '3/1/2009 10:00', '3/1/2009 11:00', '3/1/2009 12:00', '3/1/2009 13:00', '3/1/2009 14:00', '3/1/2009 15:00', '3/1/2009 16:00', '3/1/2009 17:00', '3/1/2009 18:00', '3/1/2009 19:00', '3/1/2009 20:00', '3/1/2009 21:00', '3/1/2009 22:00', '3/1/2009 23:00'
    ), 
    "Value" = c(
      NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,
      25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48,
      49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72
    )
  )  
  
  result <- get.FillValueForTimeSeries(data)
  
  for(i in 1:24) {
    if(result$Value[i] != (i+24)) {
      print("Error: value[i] must be i+24")
    }
  }
}


testEndNA <- function() {
  data <- data.frame(
    "ReadingDateTime"=c(
      '1/1/2009 0:00', '1/1/2009 1:00', '1/1/2009 2:00', '1/1/2009 3:00', '1/1/2009 4:00', '1/1/2009 5:00', '1/1/2009 6:00', '1/1/2009 7:00', '1/1/2009 8:00', '1/1/2009 9:00', '1/1/2009 10:00', '1/1/2009 11:00', '1/1/2009 12:00', '1/1/2009 13:00', '1/1/2009 14:00', '1/1/2009 15:00', '1/1/2009 16:00', '1/1/2009 17:00', '1/1/2009 18:00', '1/1/2009 19:00', '1/1/2009 20:00', '1/1/2009 21:00', '1/1/2009 22:00', '1/1/2009 23:00',
      '2/1/2009 0:00', '2/1/2009 1:00', '2/1/2009 2:00', '2/1/2009 3:00', '2/1/2009 4:00', '2/1/2009 5:00', '2/1/2009 6:00', '2/1/2009 7:00', '2/1/2009 8:00', '2/1/2009 9:00', '2/1/2009 10:00', '2/1/2009 11:00', '2/1/2009 12:00', '2/1/2009 13:00', '2/1/2009 14:00', '2/1/2009 15:00', '2/1/2009 16:00', '2/1/2009 17:00', '2/1/2009 18:00', '2/1/2009 19:00', '2/1/2009 20:00', '2/1/2009 21:00', '2/1/2009 22:00', '2/1/2009 23:00',
      '3/1/2009 0:00', '3/1/2009 1:00', '3/1/2009 2:00', '3/1/2009 3:00', '3/1/2009 4:00', '3/1/2009 5:00', '3/1/2009 6:00', '3/1/2009 7:00', '3/1/2009 8:00', '3/1/2009 9:00', '3/1/2009 10:00', '3/1/2009 11:00', '3/1/2009 12:00', '3/1/2009 13:00', '3/1/2009 14:00', '3/1/2009 15:00', '3/1/2009 16:00', '3/1/2009 17:00', '3/1/2009 18:00', '3/1/2009 19:00', '3/1/2009 20:00', '3/1/2009 21:00', '3/1/2009 22:00', '3/1/2009 23:00'
    ), 
    "Value" = c(
      1,   2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24,
      25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48,
      NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA
    )
  )  
  
  result <- get.FillValueForTimeSeries(data)
  
  for(i in 49:72) {
    if(result$Value[i] != (i-24)) {
      print("Error: value[i] must be i-24")
    }
  }
}



testFirstTwoNA <- function() {
  data <- data.frame(
    "ReadingDateTime"=c(
      '1/1/2009 0:00', '1/1/2009 1:00', '1/1/2009 2:00', '1/1/2009 3:00', '1/1/2009 4:00', '1/1/2009 5:00', '1/1/2009 6:00', '1/1/2009 7:00', '1/1/2009 8:00', '1/1/2009 9:00', '1/1/2009 10:00', '1/1/2009 11:00', '1/1/2009 12:00', '1/1/2009 13:00', '1/1/2009 14:00', '1/1/2009 15:00', '1/1/2009 16:00', '1/1/2009 17:00', '1/1/2009 18:00', '1/1/2009 19:00', '1/1/2009 20:00', '1/1/2009 21:00', '1/1/2009 22:00', '1/1/2009 23:00',
      '2/1/2009 0:00', '2/1/2009 1:00', '2/1/2009 2:00', '2/1/2009 3:00', '2/1/2009 4:00', '2/1/2009 5:00', '2/1/2009 6:00', '2/1/2009 7:00', '2/1/2009 8:00', '2/1/2009 9:00', '2/1/2009 10:00', '2/1/2009 11:00', '2/1/2009 12:00', '2/1/2009 13:00', '2/1/2009 14:00', '2/1/2009 15:00', '2/1/2009 16:00', '2/1/2009 17:00', '2/1/2009 18:00', '2/1/2009 19:00', '2/1/2009 20:00', '2/1/2009 21:00', '2/1/2009 22:00', '2/1/2009 23:00',
      '3/1/2009 0:00', '3/1/2009 1:00', '3/1/2009 2:00', '3/1/2009 3:00', '3/1/2009 4:00', '3/1/2009 5:00', '3/1/2009 6:00', '3/1/2009 7:00', '3/1/2009 8:00', '3/1/2009 9:00', '3/1/2009 10:00', '3/1/2009 11:00', '3/1/2009 12:00', '3/1/2009 13:00', '3/1/2009 14:00', '3/1/2009 15:00', '3/1/2009 16:00', '3/1/2009 17:00', '3/1/2009 18:00', '3/1/2009 19:00', '3/1/2009 20:00', '3/1/2009 21:00', '3/1/2009 22:00', '3/1/2009 23:00'
    ), 
    "Value" = c(
      NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,
      NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,
      49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72
    )
  )  
  
  result <- get.FillValueForTimeSeries(data)
  
  for(i in 1:24) {
    if(result$Value[i] != (i+48)) {
      print("Error: value[i] must be i+48")
    }
  }
  
  for(i in 25:48) {
    if(result$Value[i] != (i+24)) {
      print("Error: value[i] must be i+24")
    }
  }
}


testLastTwoNA <- function() {
  data <- data.frame(
    "ReadingDateTime"=c(
      '1/1/2009 0:00', '1/1/2009 1:00', '1/1/2009 2:00', '1/1/2009 3:00', '1/1/2009 4:00', '1/1/2009 5:00', '1/1/2009 6:00', '1/1/2009 7:00', '1/1/2009 8:00', '1/1/2009 9:00', '1/1/2009 10:00', '1/1/2009 11:00', '1/1/2009 12:00', '1/1/2009 13:00', '1/1/2009 14:00', '1/1/2009 15:00', '1/1/2009 16:00', '1/1/2009 17:00', '1/1/2009 18:00', '1/1/2009 19:00', '1/1/2009 20:00', '1/1/2009 21:00', '1/1/2009 22:00', '1/1/2009 23:00',
      '2/1/2009 0:00', '2/1/2009 1:00', '2/1/2009 2:00', '2/1/2009 3:00', '2/1/2009 4:00', '2/1/2009 5:00', '2/1/2009 6:00', '2/1/2009 7:00', '2/1/2009 8:00', '2/1/2009 9:00', '2/1/2009 10:00', '2/1/2009 11:00', '2/1/2009 12:00', '2/1/2009 13:00', '2/1/2009 14:00', '2/1/2009 15:00', '2/1/2009 16:00', '2/1/2009 17:00', '2/1/2009 18:00', '2/1/2009 19:00', '2/1/2009 20:00', '2/1/2009 21:00', '2/1/2009 22:00', '2/1/2009 23:00',
      '3/1/2009 0:00', '3/1/2009 1:00', '3/1/2009 2:00', '3/1/2009 3:00', '3/1/2009 4:00', '3/1/2009 5:00', '3/1/2009 6:00', '3/1/2009 7:00', '3/1/2009 8:00', '3/1/2009 9:00', '3/1/2009 10:00', '3/1/2009 11:00', '3/1/2009 12:00', '3/1/2009 13:00', '3/1/2009 14:00', '3/1/2009 15:00', '3/1/2009 16:00', '3/1/2009 17:00', '3/1/2009 18:00', '3/1/2009 19:00', '3/1/2009 20:00', '3/1/2009 21:00', '3/1/2009 22:00', '3/1/2009 23:00'
    ), 
    "Value" = c(
      1,   2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24,
      NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,
      NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA
    )
  )  
  
  result <- get.FillValueForTimeSeries(data)
  
  for(i in 25:48) {
    if(result$Value[i] != (i-24)) {
      print("Error: value[i] must be i-24")
    }
  }
  
  for(i in 49:72) {
    if(result$Value[i] != (i-48)) {
      print("Error: value[i] must be i-48")
    }
  }
}



testMiddleNA()
testBeginNA()
testEndNA()
testFirstTwoNA()
testLastTwoNA()